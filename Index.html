<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>√în T·∫≠p L√Ω Thuy·∫øt √Çm Nh·∫°c C∆° B·∫£n</title>
    <style>
        :root {
            --primary: #007bff;
            --success: #28a745;
            --danger: #dc3545;
            --warning: #ffc107;
            --bg: #f4f7f6;
            --card: #ffffff;
            --text: #333;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--bg);
            margin: 0;
            padding: 20px;
            color: var(--text);
            line-height: 1.6;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            background: var(--card);
            padding: 40px;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
        }

        h1, h2, h3 { text-align: center; color: var(--primary); }
        
        .screen { display: none; animation: fadeIn 0.5s; }
        .active { display: block; }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* N√∫t b·∫•m */
        .btn {
            display: inline-block;
            padding: 12px 30px;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            transition: 0.3s;
            margin: 10px 5px;
            box-shadow: 0 4px 6px rgba(0,123,255,0.2);
        }
        .btn:hover { transform: translateY(-2px); box-shadow: 0 6px 8px rgba(0,123,255,0.3); }
        .btn-restart { background: #6c757d; box-shadow: none; }
        .btn-restart:hover { background: #5a6268; }

        /* C√¢u h·ªèi */
        .question-box {
            margin-bottom: 25px;
            padding: 20px;
            border: 1px solid #e9ecef;
            border-radius: 8px;
            background: #fff;
        }
        .question-header {
            font-size: 1.1em;
            font-weight: bold;
            margin-bottom: 15px;
            color: #2c3e50;
        }
        .section-title {
            background: #e7f1ff;
            color: #0056b3;
            padding: 10px 15px;
            border-radius: 6px;
            margin: 30px 0 15px 0;
            font-weight: bold;
            border-left: 4px solid var(--primary);
        }

        .options label {
            display: flex;
            align-items: center;
            padding: 12px 15px;
            background: #f8f9fa;
            margin-bottom: 8px;
            border-radius: 6px;
            cursor: pointer;
            transition: 0.2s;
            border: 1px solid #dee2e6;
        }
        .options label:hover { background: #e9ecef; border-color: #ced4da; }
        .options input { margin-right: 15px; transform: scale(1.2); }
        .options label.selected { background: #e3f2fd; border-color: #80bdff; font-weight: 500; }

        /* Thanh th√¥ng tin */
        .info-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: #343a40;
            color: white;
            padding: 15px 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            position: sticky;
            top: 10px;
            z-index: 100;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        /* K·∫øt qu·∫£ */
        .result-summary { text-align: center; margin-bottom: 40px; }
        .score-circle {
            width: 150px;
            height: 150px;
            background: conic-gradient(var(--primary) 0%, #e9ecef 0%);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 20px;
            position: relative;
        }
        .score-inner {
            width: 130px;
            height: 130px;
            background: white;
            border-radius: 50%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }
        .score-number { font-size: 2.5em; font-weight: bold; color: var(--primary); line-height: 1; }
        .score-total { font-size: 1em; color: #6c757d; }
        
        .feedback-box {
            padding: 20px;
            border-radius: 8px;
            background: #eef;
            margin: 20px 0;
            border-left: 5px solid var(--primary);
            text-align: left;
        }

        /* Review sai */
        .review-item {
            border: 1px solid #ffdadd;
            border-left: 5px solid var(--danger);
            padding: 15px;
            background: #fff5f5;
            margin-bottom: 15px;
            border-radius: 4px;
        }
        .review-question { font-weight: bold; margin-bottom: 8px; color: #333; }
        .ans-row { margin: 5px 0; }
        .your-ans { color: var(--danger); font-weight: bold; }
        .correct-ans { color: var(--success); font-weight: bold; }
        .explanation { 
            margin-top: 10px; 
            font-size: 0.95em; 
            color: #555; 
            background: rgba(255,255,255,0.7); 
            padding: 10px; 
            border-radius: 4px;
            border: 1px dashed #ccc;
        }

        /* Responsive */
        @media (max-width: 600px) {
            .container { padding: 20px; }
            .info-bar { flex-direction: column; gap: 10px; text-align: center; }
        }
    </style>
</head>
<body>

<div class="container">
    <div id="start-screen" class="screen active">
        <h1>üéµ √în T·∫≠p L√Ω Thuy·∫øt √Çm Nh·∫°c</h1>
        <p style="text-align: center; font-size: 1.1em; color: #666;">
            B√†i ki·ªÉm tra g·ªìm <b>40 c√¢u h·ªèi</b> tr·∫Øc nghi·ªám bao ph·ªß c√°c ki·∫øn th·ª©c v·ªÅ:<br>
            Thu·ªôc t√≠nh √¢m thanh, K√Ω √¢m, Qu√£ng, Nh·ªãp ƒëi·ªáu v√† Thu·∫≠t ng·ªØ √¢m nh·∫°c.
        </p>
        
        <div style="text-align: center; margin-top: 40px;">
            <div style="font-size: 3em; margin-bottom: 20px;">üéº</div>
            <button class="btn" onclick="startQuiz()">B·∫Øt ƒë·∫ßu l√†m b√†i</button>
        </div>
    </div>

    <div id="quiz-screen" class="screen">
        <div class="info-bar">
            <span id="question-progress">Ti·∫øn ƒë·ªô: 0/40</span>
            <span id="timer">‚è±Ô∏è 00:00</span>
        </div>
        
        <div id="quiz-container">
            </div>

        <div style="text-align: center; margin-top: 30px;">
            <button class="btn" id="submit-btn" onclick="submitQuiz()">N·ªôp b√†i thi</button>
        </div>
    </div>

    <div id="result-screen" class="screen">
        <h2>K·∫øt Qu·∫£ ƒê√°nh Gi√°</h2>
        
        <div class="result-summary">
            <div class="score-circle" id="score-circle-graphic">
                <div class="score-inner">
                    <span class="score-number" id="final-score">0</span>
                    <span class="score-total">/ 40</span>
                </div>
            </div>
            <h3 id="result-text"></h3>
            
            <div class="feedback-box">
                <h4>üìù Nh·∫≠n x√©t & L·ªùi khuy√™n:</h4>
                <p id="advice-text"></p>
            </div>
        </div>

        <div id="review-section">
            <h3 style="border-bottom: 2px solid #ddd; padding-bottom: 10px; text-align: left;">
                üîç Xem l·∫°i c√°c c√¢u tr·∫£ l·ªùi sai:
            </h3>
            <div id="wrong-answers-list"></div>
        </div>

        <div style="text-align: center; margin-top: 40px;">
            <button class="btn btn-restart" onclick="location.reload()">L√†m l·∫°i ƒë·ªÅ n√†y</button>
        </div>
    </div>
</div>

<script>
    // --- D·ªÆ LI·ªÜU 40 C√ÇU H·ªéI ---
    const quizData = [
        // I. Ki·∫øn th·ª©c v·ªÅ √Çm thanh v√† Thu·ªôc t√≠nh
        { section: "I. Ki·∫øn th·ª©c v·ªÅ √Çm thanh v√† Thu·ªôc t√≠nh", q: "√Çm thanh c√≥ t√≠nh nh·∫°c kh√°c v·ªõi ti·∫øng ƒë·ªông (t·∫°p √¢m) ·ªü ƒëi·ªÉm n√†o?", o: ["C√≥ t·∫ßn s·ªë dao ƒë·ªông ƒë·ªÅu ƒë·∫∑n, x√°c ƒë·ªãnh ƒë∆∞·ª£c cao ƒë·ªô", "C√≥ c∆∞·ªùng ƒë·ªô r·∫•t l·ªõn", "Kh√¥ng c√≥ t·∫ßn s·ªë ·ªïn ƒë·ªãnh", "Do thi√™n nhi√™n t·∫°o ra"], a: 0 },
        { section: "I. Ki·∫øn th·ª©c v·ªÅ √Çm thanh v√† Thu·ªôc t√≠nh", q: "B·ªën thu·ªôc t√≠nh c∆° b·∫£n c·ªßa √¢m thanh c√≥ t√≠nh nh·∫°c l√† g√¨?", o: ["Cao ƒë·ªô, Tr∆∞·ªùng ƒë·ªô, C∆∞·ªùng ƒë·ªô, Giai ƒëi·ªáu", "Cao ƒë·ªô, Tr∆∞·ªùng ƒë·ªô, C∆∞·ªùng ƒë·ªô, √Çm s·∫Øc", "Cao ƒë·ªô, Nh·ªãp ƒë·ªô, C∆∞·ªùng ƒë·ªô, √Çm s·∫Øc", "Tr∆∞·ªùng ƒë·ªô, C∆∞·ªùng ƒë·ªô, H√≤a thanh, √Çm s·∫Øc"], a: 1 },
        { section: "I. Ki·∫øn th·ª©c v·ªÅ √Çm thanh v√† Thu·ªôc t√≠nh", q: "Cao ƒë·ªô c·ªßa √¢m thanh ph·ª• thu·ªôc v√†o y·∫øu t·ªë v·∫≠t l√Ω n√†o?", o: ["Bi√™n ƒë·ªô dao ƒë·ªông", "Th·ªùi gian dao ƒë·ªông", "T·∫ßn s·ªë dao ƒë·ªông", "H√¨nh th√°i l√†n s√≥ng"], a: 2 },
        { section: "I. Ki·∫øn th·ª©c v·ªÅ √Çm thanh v√† Thu·ªôc t√≠nh", q: "ƒê∆°n v·ªã d√πng ƒë·ªÉ ƒëo t·∫ßn s·ªë dao ƒë·ªông c·ªßa √¢m thanh l√† g√¨?", o: ["Decibel (Db)", "Hertz (Hz)", "Volt (V)", "Ampere (A)"], a: 1 },
        { section: "I. Ki·∫øn th·ª©c v·ªÅ √Çm thanh v√† Thu·ªôc t√≠nh", q: "Tai ng∆∞·ªùi c√≥ kh·∫£ nƒÉng ph√¢n bi·ªát ƒë∆∞·ª£c nh·ªØng √¢m c√≥ ƒë·ªô cao trong kho·∫£ng n√†o?", o: ["T·ª´ 16Hz ƒë·∫øn 20000Hz", "T·ª´ 27.5Hz ƒë·∫øn 4186Hz", "T·ª´ 50Hz ƒë·∫øn 1000Hz", "T·ª´ 20Hz ƒë·∫øn 2000Hz"], a: 1 },
        { section: "I. Ki·∫øn th·ª©c v·ªÅ √Çm thanh v√† Thu·ªôc t√≠nh", q: "ƒê·ªô m·∫°nh (C∆∞·ªùng ƒë·ªô) c·ªßa √¢m thanh ph·ª• thu·ªôc v√†o y·∫øu t·ªë n√†o?", o: ["T·∫ßn s·ªë dao ƒë·ªông", "Bi√™n ƒë·ªô dao ƒë·ªông (t·∫ßm c·ªØ dao ƒë·ªông)", "Th√†nh ph·∫ßn √¢m b·ªìi", "Th·ªùi gian dao ƒë·ªông"], a: 1 },
        { section: "I. Ki·∫øn th·ª©c v·ªÅ √Çm thanh v√† Thu·ªôc t√≠nh", q: "√Çm s·∫Øc (m√†u s·∫Øc c·ªßa √¢m thanh) ph·ª• thu·ªôc v√†o y·∫øu t·ªë n√†o?", o: ["ƒê·ªô to nh·ªè c·ªßa √¢m thanh", "Th√†nh ph·∫ßn c√°c √¢m c·ª•c b·ªô (√¢m b·ªìi) c√≥ trong √¢m thanh ƒë√≥", "T·ªëc ƒë·ªô c·ªßa b·∫£n nh·∫°c", "V·ªã tr√≠ n·ªët nh·∫°c tr√™n khu√¥ng"], a: 1 },
        { section: "I. Ki·∫øn th·ª©c v·ªÅ √Çm thanh v√† Thu·ªôc t√≠nh", q: "H·ªá th·ªëng √¢m thanh ƒë·∫ßy ƒë·ªß trong √¢m nh·∫°c g·ªìm bao nhi√™u √¢m kh√°c nhau?", o: ["12 √¢m", "50 √¢m", "88 √¢m", "100 √¢m"], a: 2 },
        { section: "I. Ki·∫øn th·ª©c v·ªÅ √Çm thanh v√† Thu·ªôc t√≠nh", q: "Trong t√†i li·ªáu n√†y, √¢m Si ƒë∆∞·ª£c k√Ω hi·ªáu b·∫±ng ch·ªØ c√°i g√¨?", o: ["H", "B", "S", "Si"], a: 1 },
        { section: "I. Ki·∫øn th·ª©c v·ªÅ √Çm thanh v√† Thu·ªôc t√≠nh", q: "N·ªët La ·ªü qu√£ng t√°m th·ª© nh·∫•t (A4) c√≥ t·∫ßn s·ªë chu·∫©n l√† bao nhi√™u?", o: ["432 Hz", "440 Hz", "256 Hz", "512 Hz"], a: 1 },

        // II. K√Ω √¢m v√† Khu√¥ng nh·∫°c
        { section: "II. K√Ω √¢m v√† Khu√¥ng nh·∫°c", q: "Khu√¥ng nh·∫°c bao g·ªìm m·∫•y d√≤ng k·∫ª v√† m·∫•y khe?", o: ["4 d√≤ng k·∫ª, 3 khe", "5 d√≤ng k·∫ª, 4 khe", "6 d√≤ng k·∫ª, 5 khe", "5 d√≤ng k·∫ª, 5 khe"], a: 1 },
        { section: "II. K√Ω √¢m v√† Khu√¥ng nh·∫°c", q: "Quy t·∫Øc vi·∫øt ƒëu√¥i n·ªët nh·∫°c n√†o sau ƒë√¢y l√† ƒë√∫ng?", o: ["Lu√¥n quay l√™n", "Lu√¥n quay xu·ªëng", "D∆∞·ªõi d√≤ng 3 quay l√™n, tr√™n d√≤ng 3 quay xu·ªëng", "D∆∞·ªõi d√≤ng 3 quay xu·ªëng, tr√™n d√≤ng 3 quay l√™n"], a: 2 },
        { section: "II. K√Ω √¢m v√† Khu√¥ng nh·∫°c", q: "Kh√≥a Sol x√°c ƒë·ªãnh n·ªët Sol n·∫±m ·ªü d√≤ng k·∫ª th·ª© m·∫•y?", o: ["D√≤ng 1", "D√≤ng 2", "D√≤ng 3", "D√≤ng 4"], a: 1 },
        { section: "II. K√Ω √¢m v√† Khu√¥ng nh·∫°c", q: "Kh√≥a Fa x√°c ƒë·ªãnh n·ªët Fa n·∫±m ·ªü d√≤ng k·∫ª th·ª© m·∫•y?", o: ["D√≤ng 2", "D√≤ng 3", "D√≤ng 4", "D√≤ng 5"], a: 2 },
        { section: "II. K√Ω √¢m v√† Khu√¥ng nh·∫°c", q: "Kh√≥a ƒê√¥ Alto x√°c ƒë·ªãnh n·ªët ƒê√¥ ·ªü d√≤ng k·∫ª n√†o?", o: ["D√≤ng 1", "D√≤ng 2", "D√≤ng 3", "D√≤ng 4"], a: 2 },

        // III. H·ªá th·ªëng B√¨nh qu√¢n v√† D·∫•u h√≥a
        { section: "III. H·ªá th·ªëng B√¨nh qu√¢n v√† D·∫•u h√≥a", q: "Trong h·ªá th·ªëng b√¨nh qu√¢n, m·ªôt qu√£ng t√°m ƒë∆∞·ª£c chia th√†nh bao nhi√™u ph·∫ßn b·∫±ng nhau?", o: ["7 ph·∫ßn", "12 ph·∫ßn (12 n·ª≠a cung)", "24 ph·∫ßn", "10 ph·∫ßn"], a: 1 },
        { section: "III. H·ªá th·ªëng B√¨nh qu√¢n v√† D·∫•u h√≥a", q: "Kho·∫£ng c√°ch h·∫πp nh·∫•t gi·ªØa hai b·∫≠c c·ªßa thang √¢m c∆° b·∫£n l√† g√¨?", o: ["M·ªôt cung", "N·ª≠a cung", "1/4 cung", "M·ªôt qu√£ng t√°m"], a: 1 },
        { section: "III. H·ªá th·ªëng B√¨nh qu√¢n v√† D·∫•u h√≥a", q: "Gi·ªØa c√°c b·∫≠c c∆° b·∫£n Mi - Fa v√† Si - ƒê√¥ l√† kho·∫£ng c√°ch g√¨?", o: ["M·ªôt cung", "N·ª≠a cung", "M·ªôt cung r∆∞·ª°i", "Hai cung"], a: 1 },
        { section: "III. H·ªá th·ªëng B√¨nh qu√¢n v√† D·∫•u h√≥a", q: "D·∫•u thƒÉng (#) c√≥ t√°c d·ª•ng g√¨?", o: ["H·∫° th·∫•p n·ªët nh·∫°c 1/2 cung", "N√¢ng cao n·ªët nh·∫°c 1/2 cung", "H·ªßy b·ªè d·∫•u h√≥a tr∆∞·ªõc ƒë√≥", "N√¢ng cao n·ªët nh·∫°c 1 cung"], a: 1 },
        { section: "III. H·ªá th·ªëng B√¨nh qu√¢n v√† D·∫•u h√≥a", q: "D·∫•u gi√°ng (b) c√≥ t√°c d·ª•ng g√¨?", o: ["H·∫° th·∫•p n·ªët nh·∫°c 1/2 cung", "N√¢ng cao n·ªët nh·∫°c 1/2 cung", "H·∫° th·∫•p n·ªët nh·∫°c 1 cung", "Gi·ªØ nguy√™n cao ƒë·ªô"], a: 0 },
        { section: "III. H·ªá th·ªëng B√¨nh qu√¢n v√† D·∫•u h√≥a", q: "Tr√πng √¢m l√† g√¨?", o: ["Hai √¢m thanh kh√°c nhau ho√†n to√†n", "C√°c b·∫≠c √¢m c√≥ c√πng ƒë·ªô cao nh∆∞ng kh√°c t√™n g·ªçi v√† k√Ω hi·ªáu", "Hai √¢m thanh c√≥ t√™n g·ªçi gi·ªëng nhau nh∆∞ng ƒë·ªô cao kh√°c nhau", "√Çm thanh l·∫∑p l·∫°i c·ªßa m·ªôt n·ªët"], a: 1 },
        { section: "III. H·ªá th·ªëng B√¨nh qu√¢n v√† D·∫•u h√≥a", q: "N·ª≠a cung Diatonic l√† g√¨?", o: ["N·ª≠a cung t·∫°o b·ªüi 2 b·∫≠c c√πng t√™n", "N·ª≠a cung t·∫°o b·ªüi 2 b·∫≠c c∆° b·∫£n li·ªÅn k·ªÅ ho·∫∑c kh√°c t√™n", "N·ª≠a cung l·ªõn h∆°n b√¨nh th∆∞·ªùng", "N·ª≠a cung nh·ªè h∆°n b√¨nh th∆∞·ªùng"], a: 1 },
        { section: "III. H·ªá th·ªëng B√¨nh qu√¢n v√† D·∫•u h√≥a", q: "N·ª≠a cung Chromatic l√† g√¨?", o: ["N·ª≠a cung t·∫°o b·ªüi 2 b·∫≠c c√πng t√™n", "N·ª≠a cung t·∫°o b·ªüi 2 b·∫≠c kh√°c t√™n", "Kho·∫£ng c√°ch gi·ªØa Mi v√† Fa", "Kho·∫£ng c√°ch gi·ªØa Si v√† ƒê√¥"], a: 0 },

        // IV. Tr∆∞·ªùng ƒë·ªô v√† Nh·ªãp ƒëi·ªáu
        { section: "IV. Tr∆∞·ªùng ƒë·ªô v√† Nh·ªãp ƒëi·ªáu", q: "D·∫•u ch·∫•m d√¥i ƒë·∫∑t b√™n ph·∫£i n·ªët nh·∫°c c√≥ t√°c d·ª•ng g√¨?", o: ["L√†m n·ªët nh·∫°c ƒë·∫πp h∆°n", "TƒÉng th√™m m·ªôt n·ª≠a gi√° tr·ªã tr∆∞·ªùng ƒë·ªô c·ªßa ch√≠nh n·ªët ƒë√≥", "TƒÉng g·∫•p ƒë√¥i tr∆∞·ªùng ƒë·ªô n·ªët ƒë√≥", "Ng·∫Øt √¢m thanh ngay l·∫≠p t·ª©c"], a: 1 },
        { section: "IV. Tr∆∞·ªùng ƒë·ªô v√† Nh·ªãp ƒëi·ªáu", q: "D·∫•u n·ªëi (c√πng cao ƒë·ªô) d√πng ƒë·ªÉ l√†m g√¨?", o: ["N·ªëi li·ªÅn hai n·ªët kh√°c cao ƒë·ªô ƒë·ªÉ h√°t luy·∫øn", "N·ªëi li·ªÅn hai n·ªët c√≥ c√πng cao ƒë·ªô ƒë·ªÉ k√©o d√†i tr∆∞·ªùng ƒë·ªô", "Ng·∫Øt ti·∫øng gi·ªØa hai n·ªët", "TƒÉng c∆∞·ªùng ƒë·ªô c·ªßa n·ªët sau"], a: 1 },
        { section: "IV. Tr∆∞·ªùng ƒë·ªô v√† Nh·ªãp ƒëi·ªáu", q: "D·∫•u mi·ªÖn nh·ªãp (Fermata) c√≥ √Ω nghƒ©a g√¨?", o: ["Ngh·ªâ bao l√¢u t√πy √Ω ng∆∞·ªùi ch·ªâ huy ho·∫∑c ng∆∞·ªùi bi·ªÉu di·ªÖn", "Ngh·ªâ ƒë√∫ng 1 ph√°ch", "TƒÉng t·ªëc ƒë·ªô b·∫£n nh·∫°c", "K·∫øt th√∫c b·∫£n nh·∫°c ngay l·∫≠p t·ª©c"], a: 0 },
        { section: "IV. Tr∆∞·ªùng ƒë·ªô v√† Nh·ªãp ƒëi·ªáu", q: "Nh·ªãp ƒëi·ªáu (Rhythm) l√† g√¨?", o: ["S·ª± chuy·ªÉn ƒë·ªông nhanh hay ch·∫≠m c·ªßa b·∫£n nh·∫°c", "S·ª± n·ªëi ti·∫øp c√°c ƒë·ªô d√†i c·ªßa √¢m thanh c√≥ t·ªï ch·ª©c", "ƒê·ªô vang to nh·ªè c·ªßa √¢m thanh", "M√†u s·∫Øc c·ªßa √¢m thanh"], a: 1 },
        { section: "IV. Tr∆∞·ªùng ƒë·ªô v√† Nh·ªãp ƒëi·ªáu", q: "Trong m·ªôt √¥ nh·ªãp, ph√°ch c√≥ tr·ªçng √¢m g·ªçi l√† g√¨?", o: ["Ph√°ch nh·∫π", "Ph√°ch m·∫°nh", "ƒê·∫£o ph√°ch", "Ngh·ªãch ph√°ch"], a: 1 },
        { section: "IV. Tr∆∞·ªùng ƒë·ªô v√† Nh·ªãp ƒëi·ªáu", q: "S·ªë ch·ªâ nh·ªãp 2/4 c√≥ √Ω nghƒ©a g√¨?", o: ["C√≥ 2 ph√°ch, m·ªói ph√°ch b·∫±ng 1 n·ªët tr·∫Øng", "C√≥ 4 ph√°ch, m·ªói ph√°ch b·∫±ng 1 n·ªët ƒëen", "C√≥ 2 ph√°ch, m·ªói ph√°ch b·∫±ng 1 n·ªët ƒëen", "C√≥ 2 ph√°ch, m·ªói ph√°ch b·∫±ng 1 n·ªët m√≥c ƒë∆°n"], a: 2 },
        { section: "IV. Tr∆∞·ªùng ƒë·ªô v√† Nh·ªãp ƒëi·ªáu", q: "Nh·ªãp 3/4 c√≥ t√≠nh ch·∫•t nh∆∞ th·∫ø n√†o?", o: ["Nh·ªãp ƒë∆°n, 3 ph√°ch: M·∫°nh - Nh·∫π - Nh·∫π", "Nh·ªãp k√©p, 3 ph√°ch: M·∫°nh - M·∫°nh v·ª´a - Nh·∫π", "Nh·ªãp ƒë∆°n, 2 ph√°ch", "Nh·ªãp h·ªón h·ª£p"], a: 0 },
        { section: "IV. Tr∆∞·ªùng ƒë·ªô v√† Nh·ªãp ƒëi·ªáu", q: "Nh·ªãp 4/4 (C) g·ªìm c√°c ph√°ch c√≥ t√≠nh ch·∫•t nh∆∞ th·∫ø n√†o?", o: ["M·∫°nh - Nh·∫π - Nh·∫π - Nh·∫π", "M·∫°nh - Nh·∫π - M·∫°nh v·ª´a - Nh·∫π", "M·∫°nh - M·∫°nh - M·∫°nh - M·∫°nh", "Nh·∫π - M·∫°nh - Nh·∫π - M·∫°nh"], a: 1 },

        // V. C√°c k√Ω hi·ªáu v√† Thu·∫≠t ng·ªØ Nh·ªãp ƒë·ªô
        { section: "V. C√°c k√Ω hi·ªáu v√† Thu·∫≠t ng·ªØ Nh·ªãp ƒë·ªô", q: "V·∫°ch nh·ªãp k√©p (Double bar line) d√πng ƒë·ªÉ l√†m g√¨?", o: ["Ch·ªâ d√πng ƒë·ªÉ k·∫øt th√∫c b√†i", "B√°o hi·ªáu thay ƒë·ªïi lo·∫°i nh·ªãp, kh√≥a nh·∫°c ho·∫∑c k·∫øt ƒëo·∫°n", "Chia ƒë√¥i √¥ nh·ªãp", "Kh√¥ng c√≥ t√°c d·ª•ng g√¨ ƒë·∫∑c bi·ªát"], a: 1 },
        { section: "V. C√°c k√Ω hi·ªáu v√† Thu·∫≠t ng·ªØ Nh·ªãp ƒë·ªô", q: "Nh·ªãp l·∫•y ƒë√† (Up-beat) l√† hi·ªán t∆∞·ª£ng g√¨?", o: ["B·∫£n nh·∫°c k·∫øt th√∫c b·∫±ng √¥ nh·ªãp thi·∫øu", "B·∫£n nh·∫°c b·∫Øt ƒë·∫ßu v·ªõi √¥ nh·ªãp kh√¥ng ƒë·ªß s·ªë ph√°ch quy ƒë·ªãnh", "B·∫£n nh·∫°c c√≥ t·ªëc ƒë·ªô r·∫•t nhanh", "Ng∆∞·ªùi ch·ªâ huy ƒë√°nh nh·ªãp tr∆∞·ªõc khi h√°t"], a: 1 },
        { section: "V. C√°c k√Ω hi·ªáu v√† Thu·∫≠t ng·ªØ Nh·ªãp ƒë·ªô", q: "Hi·ªán t∆∞·ª£ng ƒë·∫£o ph√°ch (Syncopation) l√† g√¨?", o: ["Tr·ªçng √¢m r∆°i v√†o ph√°ch m·∫°nh", "Tr·ªçng √¢m chuy·ªÉn t·ª´ ph√°ch m·∫°nh sang ph√°ch nh·∫π", "H√°t sai nh·ªãp", "Thay ƒë·ªïi s·ªë ch·ªâ nh·ªãp li√™n t·ª•c"], a: 1 },
        { section: "V. C√°c k√Ω hi·ªáu v√† Thu·∫≠t ng·ªØ Nh·ªãp ƒë·ªô", q: "Thu·∫≠t ng·ªØ 'Largo' c√≥ nghƒ©a l√† g√¨?", o: ["R·∫•t nhanh", "H∆°i nhanh", "C·ª±c ch·∫≠m, r·ªông r√£i", "V·ª´a ph·∫£i"], a: 2 },
        { section: "V. C√°c k√Ω hi·ªáu v√† Thu·∫≠t ng·ªØ Nh·ªãp ƒë·ªô", q: "Thu·∫≠t ng·ªØ 'Andante' ch·ªâ t·ªëc ƒë·ªô n√†o?", o: ["Nhanh vui", "Ch·∫≠m v·ª´a (nh∆∞ b∆∞·ªõc ƒëi)", "R·∫•t nhanh", "H∆°i ch·∫≠m"], a: 1 },
        { section: "V. C√°c k√Ω hi·ªáu v√† Thu·∫≠t ng·ªØ Nh·ªãp ƒë·ªô", q: "Thu·∫≠t ng·ªØ 'Allegro' ch·ªâ t·ªëc ƒë·ªô n√†o?", o: ["Ch·∫≠m", "V·ª´a ph·∫£i", "Nhanh", "R·∫•t ch·∫≠m"], a: 2 },
        { section: "V. C√°c k√Ω hi·ªáu v√† Thu·∫≠t ng·ªØ Nh·ªãp ƒë·ªô", q: "Thu·∫≠t ng·ªØ 'Ritardando' (rit.) c√≥ nghƒ©a l√† g√¨?", o: ["Nhanh d·∫ßn l√™n", "Ch·∫≠m d·∫ßn l·∫°i", "Gi·ªØ nguy√™n t·ªëc ƒë·ªô", "Quay l·∫°i t·ª´ ƒë·∫ßu"], a: 1 },
        { section: "V. C√°c k√Ω hi·ªáu v√† Thu·∫≠t ng·ªØ Nh·ªãp ƒë·ªô", q: "D·∫•u h·ªìi (Segno) d√πng ƒë·ªÉ l√†m g√¨?", o: ["K·∫øt th√∫c b√†i", "Nh·∫Øc l·∫°i t·ª´ v·ªã tr√≠ c√≥ d·∫•u Segno", "TƒÉng √¢m l∆∞·ª£ng", "Gi·∫£m √¢m l∆∞·ª£ng"], a: 1 },
        { section: "V. C√°c k√Ω hi·ªáu v√† Thu·∫≠t ng·ªØ Nh·ªãp ƒë·ªô", q: "D·∫•u Coda th∆∞·ªùng ƒëi k√®m v·ªõi d·∫•u n√†o ƒë·ªÉ ch·ªâ ph·∫ßn k·∫øt?", o: ["D·∫•u nh·∫Øc l·∫°i", "D·∫•u h·ªìi (Segno) ho·∫∑c Da Capo", "D·∫•u luy·∫øn", "D·∫•u thƒÉng"], a: 1 }
    ];

    let userAnswers = {};
    let timerInterval;
    let seconds = 0;

    function startQuiz() {
        document.getElementById('start-screen').classList.remove('active');
        document.getElementById('quiz-screen').classList.add('active');
        renderQuestions();
        startTimer();
    }

    function renderQuestions() {
        const container = document.getElementById('quiz-container');
        container.innerHTML = '';
        
        let currentSection = '';

        quizData.forEach((item, index) => {
            // Th√™m ti√™u ƒë·ªÅ Section n·∫øu thay ƒë·ªïi
            if (item.section !== currentSection) {
                const sectionHeader = document.createElement('div');
                sectionHeader.className = 'section-title';
                sectionHeader.innerText = item.section;
                container.appendChild(sectionHeader);
                currentSection = item.section;
            }

            const qBox = document.createElement('div');
            qBox.className = 'question-box';
            
            let optionsHtml = '';
            item.o.forEach((opt, optIndex) => {
                optionsHtml += `
                    <label onclick="selectOption(this, ${index})">
                        <input type="radio" name="q_${index}" value="${optIndex}" onchange="saveAnswer(${index}, ${optIndex})">
                        ${opt}
                    </label>
                `;
            });

            qBox.innerHTML = `
                <div class="question-header">C√¢u ${index + 1}: ${item.q}</div>
                <div class="options">${optionsHtml}</div>
            `;
            container.appendChild(qBox);
        });
    }

    function selectOption(label, questionIndex) {
        // X√≥a class selected ·ªü c√°c label kh√°c trong c√πng c√¢u h·ªèi
        const allLabels = label.parentElement.querySelectorAll('label');
        allLabels.forEach(l => l.classList.remove('selected'));
        // Th√™m class selected v√†o label ƒë∆∞·ª£c ch·ªçn
        label.classList.add('selected');
    }

    function saveAnswer(qIndex, ansIndex) {
        userAnswers[qIndex] = ansIndex;
        // C·∫≠p nh·∫≠t thanh ti·∫øn ƒë·ªô
        const answeredCount = Object.keys(userAnswers).length;
        document.getElementById('question-progress').innerText = `Ti·∫øn ƒë·ªô: ${answeredCount}/${quizData.length}`;
    }

    function startTimer() {
        timerInterval = setInterval(() => {
            seconds++;
            const mins = Math.floor(seconds / 60).toString().padStart(2, '0');
            const secs = (seconds % 60).toString().padStart(2, '0');
            document.getElementById('timer').innerText = `‚è±Ô∏è ${mins}:${secs}`;
        }, 1000);
    }

    function submitQuiz() {
        if (!confirm("B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën n·ªôp b√†i kh√¥ng?")) return;

        clearInterval(timerInterval);
        
        let score = 0;
        let wrongAnswersHtml = '';
        
        quizData.forEach((q, index) => {
            const userPick = userAnswers[index];
            const isCorrect = userPick === q.a;
            
            if (isCorrect) {
                score++;
            } else {
                const userText = userPick !== undefined ? q.o[userPick] : "<span style='color:gray'>Ch∆∞a tr·∫£ l·ªùi</span>";
                const correctText = q.o[q.a];
                
                wrongAnswersHtml += `
                    <div class="review-item">
                        <div class="review-question">C√¢u ${index + 1}: ${q.q}</div>
                        <div class="ans-row">‚ùå B·∫°n ch·ªçn: <span class="your-ans">${userText}</span></div>
                        <div class="ans-row">‚úÖ ƒê√°p √°n ƒë√∫ng: <span class="correct-ans">${correctText}</span></div>
                        <div class="explanation">üí° <b>Ghi nh·ªõ:</b> ${correctText}</div>
                    </div>
                `;
            }
        });

        // T√≠nh ƒëi·ªÉm v√† hi·ªÉn th·ªã
        const percent = Math.round((score / quizData.length) * 100);
        
        // Logic l·ªùi khuy√™n
        let advice = "";
        let colorVar = "";
        
        if (percent === 100) {
            advice = "Tuy·ªát v·ªùi! B·∫°n ƒë√£ n·∫Øm v·ªØng to√†n b·ªô ki·∫øn th·ª©c l√Ω thuy·∫øt c∆° b·∫£n. B·∫°n ƒë√£ s·∫µn s√†ng cho c√°c k·ª≥ thi n√¢ng cao h∆°n!";
            colorVar = "var(--success)";
        } else if (percent >= 80) {
            advice = "R·∫•t t·ªët! B·∫°n c√≥ n·ªÅn t·∫£ng ki·∫øn th·ª©c v·ªØng ch·∫Øc. H√£y xem l·∫°i nh·ªØng l·ªói sai nh·ªè ·ªü d∆∞·ªõi ƒë·ªÉ ƒë·∫°t ƒëi·ªÉm tuy·ªát ƒë·ªëi nh√©.";
            colorVar = "var(--primary)";
        } else if (percent >= 50) {
            advice = "K·∫øt qu·∫£ t·∫°m ·ªïn. B·∫°n ƒë√£ hi·ªÉu c√°c kh√°i ni·ªám c∆° b·∫£n nh∆∞ng v·∫´n c√≤n nh·∫ßm l·∫´n ·ªü m·ªôt s·ªë ƒë·ªãnh nghƒ©a chi ti·∫øt. H√£y √¥n l·∫°i k·ªπ ph·∫ßn 'H·ªá th·ªëng b√¨nh qu√¢n' v√† 'C√°c thu·∫≠t ng·ªØ nh·ªãp ƒë·ªô'.";
            colorVar = "var(--warning)";
        } else {
            advice = "B·∫°n c·∫ßn c·ªë g·∫Øng nhi·ªÅu h∆°n. C√≥ v·∫ª nh∆∞ b·∫°n ch∆∞a n·∫Øm ch·∫Øc c√°c ƒë·ªãnh nghƒ©a c∆° b·∫£n v·ªÅ cao ƒë·ªô, tr∆∞·ªùng ƒë·ªô v√† k√Ω √¢m. H√£y d√†nh th·ªùi gian ƒë·ªçc l·∫°i gi√°o tr√¨nh v√† l√†m l·∫°i b√†i tr·∫Øc nghi·ªám n√†y.";
            colorVar = "var(--danger)";
        }

        document.getElementById('quiz-screen').classList.remove('active');
        document.getElementById('result-screen').classList.add('active');
        
        document.getElementById('final-score').innerText = score;
        document.getElementById('result-text').innerText = `${percent}% - ${score >= 32 ? 'ƒê·∫°t Y√™u C·∫ßu' : 'C·∫ßn C·ªë G·∫Øng'}`;
        document.getElementById('advice-text').innerText = advice;
        
        // V·∫Ω bi·ªÉu ƒë·ªì tr√≤n css
        const circle = document.getElementById('score-circle-graphic');
        circle.style.background = `conic-gradient(${colorVar} ${percent}%, #e9ecef ${percent}%)`;
        document.getElementById('final-score').style.color = colorVar;

        const reviewList = document.getElementById('wrong-answers-list');
        if (wrongAnswersHtml === '') {
            reviewList.innerHTML = '<p style="text-align:center; color:green; font-weight:bold; font-size:1.2em;">üéâ Xu·∫•t s·∫Øc! B·∫°n kh√¥ng sai c√¢u n√†o.</p>';
        } else {
            reviewList.innerHTML = wrongAnswersHtml;
        }

        window.scrollTo(0, 0);
    }
</script>

</body>
</html>
